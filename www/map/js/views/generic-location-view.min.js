suApp.view.GenericLocationView=Backbone.View.extend({initialize:function(a){_.bindAll(this,"updatePosition","updateVisibility","handleMarkerClick");this.gmap=a.gmap;this.infoWindow=a.infoWindow;google.maps.event.addListener(this.marker,"click",this.handleMarkerClick);this.model.on("click",this.handleMarkerClick);this.model.on("change:coords",this.updatePosition);this.model.on("change:visible",this.updateVisibility);this.render()},render:function(){this.updateVisibility();this.marker.setMap(this.gmap)},
updatePosition:function(){},updateVisibility:function(){this.marker&&this.marker.setVisible(this.model.isVisible())},openInfoWindow:function(a,b){this.infoWindow.open(a,b,this.getCenter());this.gmap.panTo(b.getPosition());this.gmap.panBy(40,-100)},getCenter:function(){if(0<this.model.getGPoints().length){var a=0,b=0,c=0;$(this.model.getGPoints()).each(function(e,d){a+=d.lat();b+=d.lng();c++});return new google.maps.LatLng(a/c,b/c)}return-1},handleMarkerClick:function(a){this.model.trigger("clicked");
this.model.get("directionAware")&&this.infoWindow.setDestination(this.getCenter());this.openInfoWindow(this.model,this.marker)},remove:function(){this.infoWindow.close();this.marker.setMap(null);this.marker=null;Backbone.View.prototype.remove.call(this)}});