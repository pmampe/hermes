suApp.view.SearchView=Backbone.View.extend({initialize:function(a){_.bindAll(this,"render","populateFilter");this.inputField=$("#search-autocomplete").parent().find("form input");this.inputField.get(0).type="search";a.placeholderSuffix&&this.inputField.attr("placeholder",i18n.t("map.menu.searchfor")+i18n.t(a.placeholderSuffix).toLowerCase());$("#search-autocomplete").listview("option","filterCallback",this.filterSearch);this.collection.on("reset",this.render)},events:{"focus input":"showFilteredList",
"keyup input":"inputKeyup","click #cancelFilter":"handleCancelClick","click .autocomplete-link":"showClickedLoction"},render:function(){this.populateFilter();this.delegateEvents();-1<this.options.types.indexOf("auditorium")&&this.showFilteredList()},inputKeyup:function(a){13===a.which&&$(a.target).trigger("blur");a=$("#noresults");var b=$("#search-autocomplete").children(":visible").length;0===b&&!a.is(":visible")?a.show():0<b&&a.is(":visible")&&a.hide()},showFilteredList:function(){$("#search-box form").addClass("tight");
$("#cancelFilter").show();if(""!==$("div#search-box input").val()){var a=this.inputField.val();this.inputField.val("").trigger("change");this.inputField.val(a).trigger("change")}else $("#search-autocomplete li").removeClass("ui-screen-hidden")},handleCancelClick:function(a){a.preventDefault();this.hideFilteredList();""===this.inputField.val()&&this.resetLocations();this.inputField.blur()},hideFilteredList:function(){$("#search-box form").removeClass("tight");$("#cancelFilter").hide();$("#search-autocomplete li").addClass("ui-screen-hidden")},
getClickedLocation:function(a){a=$(a).attr("data-modelid");return this.collection.get(a)},showClickedLoction:function(a,b){if(!a.isDefaultPrevented()){this.hideFilteredList();var c=this.getClickedLocation(a.target);this.trigger("selected",c);this.inputField.blur()}},resetLocations:function(){this.trigger("selected",null)},populateFilter:function(){var a=this.collection.bySearchable().sortBy(function(a){return a.getI18n("name")}).reduce(function(a,b){return a+'\x3cli id\x3d"'+b.get("id")+'" data-icon\x3d"false"\x3e\x3ca data-modelid\x3d"'+
b.get("id")+'" class\x3d"autocomplete-link"\x3e'+b.getI18n("name")+"\x3c/a\x3e\x3c/li\x3e"},""),b=$("#search-autocomplete");b.hide();b.html(a);b.listview("refresh");b.trigger("updatelayout");this.inputField.is(":focus")||this.hideFilteredList();b.show()},filterSearch:function(a,b){b=b.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26").replace(/[^\\||\s]/g,"$\x26\\s*").replace(/\s/g,"\\s*");return!RegExp("(^| )"+b,"i").test(a)}});